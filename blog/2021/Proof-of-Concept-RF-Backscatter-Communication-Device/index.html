<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Charles D. Ramey | Proof of Concept RF Backscatter Communication Device</title>
<meta name="description" content="GaTech PhD student advised by Professor Thad Starner. I specialize in computational materials, pattern recognition, and robotics.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2021/Proof-of-Concept-RF-Backscatter-Communication-Device/">

    
<!-- MathJax -->
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light bg-white navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Charles</span> D.  Ramey
      </a>
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/media/">
                media
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Proof of Concept RF Backscatter Communication Device</h1>
    <p class="post-meta">January 8, 2021</p>
  </header>

  <article class="post-content">
    <p><img src="/assets/img/sky65050_tag.jpg" alt="" /></p>
<h2 id="motivation">Motivation</h2>
<p>Radio frequency back scatter devices (also known as retro-reflectors) were first popularized by “the thing” back in the 1940’s. Invented by Leon Thermin (of the <a href="https://en.wikipedia.org/wiki/Theremin">Theremin instrument</a>), “the thing” was a covert listening device which functioned by modulating radio frequency signals when audio waves hit it. 
These devices typically consume increasingly little power (on the order of micro watts) since they only need to <em>modulate</em> RF signals rather than transmit them. In practice this means the device either allows ambient RF to pass through an antenna or passes a weak electrical signal through the antenna. This process only requires a single transistor and an antenna.</p>

<p>Sounds simple right? In theory, yes! I have found that the practice however is riddled with engineering challenges.</p>

<p>My goal with this blog post is to outline a device which is as simple as possible to construct and demonstrate the principles of RF backscatter communications. Hopefully this will help others get started with these techniques.</p>
<hr />

<h2 id="parts-list">Parts List</h2>
<p>Before we dive too deep, here is a list of the electrical components you’ll need to follow along at home:</p>
<ul>
  <li><a href="https://www.mouser.com/ProductDetail/Skyworks-Solutions-Inc/SKY65050-372LF/?qs=%2Fha2pyFadui0THw%252BGPCs1E0dnAjoZc2lCtKkDLlV6KE%3D">SKY65050 RF Transistor</a></li>
  <li>20ish Ohm Resistor (I used a 22 Ohm)</li>
  <li>1uF capacitor</li>
  <li>1inch of wire (for creating the antenna)</li>
  <li><a href="https://www.amazon.com/QLOUNI-40pcs-Boards-Adapter-Converter/dp/B07CJ96ZPW/ref=asc_df_B07CJ96ZPW/?tag=hyprod-20&amp;linkCode=df0&amp;hvadid=312209999515&amp;hvpos=&amp;hvnetw=g&amp;hvrand=8035907597186751462&amp;hvpone=&amp;hvptwo=&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9010957&amp;hvtargid=pla-569794975601&amp;psc=1">SOP 10 .5mm breakout board</a> (This is optional as you could totally solder this all point-to-point with no PCB)</li>
</ul>

<p>Additionally I’ll be utilizing the following equipment:</p>
<ul>
  <li>Regulated Bench DC Power Supply (Anything capable of supplying +3VDC @20mA will suffice)</li>
  <li>Arbitrary function generator (Anything capable of producing a 0v-5v 100Khz-5MHz square wave will suffice)</li>
  <li>Oscilloscope (Optional but helpful for debugging)</li>
  <li>Two HackRF One SDRs</li>
  <li>Two 2.4Ghz Antennas (You can borrow some wifi antennas off of a wifi router or order some directional high gain antennas from amazon. I recommend <a href="https://www.amazon.com/1-35GHz-9-5GHz-Log-Periodic-Directional-Antenna-Connector/dp/B0781FHTT1/ref=sxts_sxwds-bia-wc-rsf1_0?cv_ct_cx=log+periodic+antenna&amp;dchild=1&amp;keywords=log+periodic+antenna&amp;pd_rd_i=B0781FHTT1&amp;pd_rd_r=b9b1732d-ae53-4889-ac65-ad079cf2e42f&amp;pd_rd_w=okfRR&amp;pd_rd_wg=BPRPU&amp;pf_rd_p=e0f994a8-a359-40a9-8917-dadca71c7184&amp;pf_rd_r=YG1X5JJ6N1JTS2FHG2ZQ&amp;psc=1&amp;qid=1610120840&amp;sr=1-1-526ea17f-3f73-4b50-8cd8-6acff948fa5a">this log periodic antenna</a>)</li>
</ul>

<hr />

<h2 id="backscatter-communication-architecture">Backscatter Communication Architecture</h2>

<p><img src="/assets/img/architecture.png" alt="This image was taken from: https://doi.org/10.1145/3133956.3138830" /></p>

<p>Typically backscatter sensors require a radio transmitter and a radio receiver. The transmitter sends energy towards the sensor in the form of radio waves. The sensor then modulates these radio waves and in the process some of these waves are scattered back towards the radio receiver. Fortunately for modern engineers such as ourselves, we have software defined radios which can handle both the transmitting and receiving radio tasks! For the purposes of my demonstration, I’ll be using two HackRF’s. While these SDRs aren’t quite cheap, they are at least readily available for purchase.</p>
<hr />

<h2 id="circuit-schematic">Circuit Schematic</h2>
<p><img src="/assets/img/sky65050_backscatter_schematic.jpg" alt="" /></p>

<p>As always, I’d recommend doing a quick read through of the SKY65050  <a href="https://www.mouser.com/datasheet/2/472/SKY65050_372LF_200967G-1501297.pdf">data sheet</a>. As far as data sheets go, I found this one in particular to be quite helpful and pretty straightforward to read. It’s important to note several things mentioned in this data sheet, and we can learn a lot from the provided schematic of the SKY65050 evaluation board. That being said, there is also a lot of information in this data sheet which we can safely ignore for now since we aren’t trying to actually achieve this device’s full specs of capability for RF switching.
Of particular note:
-If we’re thinking of this device/transistor as a switch, the analogy would liken this SKY65050 to a normally closed switch. That means, when no signal is applied to the gate of the transistor, the device allows current to flow from drain to source (and vice versa I believe?)
-Typically this transistor wants to be negative biased which would require us to apply less than or equal to -3V to the gate in order to open the switch and prevent current from flowing between the drain and source
-The requirement for a negative voltage gate drive signal can be eliminated with an appropriate resistor and capacitor wired in parallel with each other and connect between one of the SKY65050’s source leads and ground (this is described at the bottom of page 2 in the data sheet)
-While both the data sheet and my hand drawn schematic above call for a capacitor to be placed between the gate and source of the SKY65050. The data sheet specifies that this capacitor value is supposed to be .1pF. Since .1pF is such a tiny capacitance value, I just totally omitted it and connected the gate and source directly together with a small jumper wire. (I think this capacitor is normally there for impedance matching. If we were really engineering for super high efficiency, we’d probably think harder about including it but for our purposes omitting it seems to work just fine)</p>
<hr />

<h2 id="supporting-equipment">Supporting Equipment</h2>
<h3 id="3-volt-002a-power-supply">3 Volt 0.02A Power Supply</h3>
<p>In practice, pHEMT RF switches like the one we’re using can be engineered to switch without a voltage applied to their drain. For the purposes of our demo, we’re applying 3volts with a current limit of 20mA to the drain of the SKY65050. This small voltage is utilized to make the self-biasing scheme work that the switch’s data sheet recommends. You can use any 3v power supply you like but a regulated bench supply is one less thing to debug if things aren’t going to plan.</p>
<h3 id="frequency-generator">Frequency Generator</h3>
<p>While normally you’d want a backscatter sensor to actually sense something, for the purposes of this demonstration we’d like to utilize a known fake sensed signal to aid in our inevitable debugging efforts. This known signal will be a 5v high peak, 0v low peak square wave generated by a frequency generator. Square wave frequencies between  a few KHz on up to several MHz should all work just fine.
As you can see above, I’m utilizing a bench top arbitrary function generator. While you could easily also use a micro-controller’s digital output or 555 timer IC  to generate a square wave with appropriate frequency and amplitude, the bench top function generator is one less thing to debug if the device isn’t behaving as expected.</p>
<h3 id="oscilloscope">Oscilloscope</h3>
<p>While an oscilloscope is not absolutely required for this demonstration, I’d recommend utilizing a scope which can sample at the frequency (er, double the frequency because Nyquist, but you get my point)  of the square wave we’re applying across the gate of the SKY65050. Again, in our case that’ll be a range between several KHz to several MHz. Most ‘scopes should be able to handle this sort of task. By utilizing a oscilloscope we can directly probe the antenna attached to the backscatter circuit. Ideally you’ll see this antenna oscillating at the same frequency of the applied square wave from the function generator.</p>
<hr />

<h2 id="gnu-radio-flow-graph">GNU Radio Flow graph</h2>
<p><img src="/assets/img/grc.png" alt="" />
I was able to successfully use Michael Ossmann’s CONGAFLOCK gnuradio flow graph file to get this experiment working. There were however a few notable hiccups along the way. I’m attaching the above image as a reference for how things in this flow graph should look but your setup may differ slightly based on how your versions of gnuradio, osmosdr, and python are installed.
Here are a few of the hiccups I encountered and some brief notes on getting around them:</p>
<ul>
  <li>For some reason, I was not able to successfully save the file directly from github and then have it work in gnuradio (upon trying to load these files, gnuradio would spit out a bunch of python parsing errors). I found that viewing raw, selecting all, copy and pasting into a empty file, and then saving as a .grc file resulted in a file which would successfully load into gnuradio</li>
  <li>Once I was able to successfully load the grc file into gnuradio, I found that gnuradio was unable to properly load several of the flow graph blocks due to my installation utilizing Py QT (versus Michael Ossmann’s using WX GUI). This was rectified by going through these blocks one by one and manually replacing them with their Py QT equivalents.</li>
  <li>Finally, my last hurdle was figuring out how to utilize two HackRF One’s on  a single computer: The key to this relies on the hackrf_info command from the hackrf command line tools and device arguments field in the osmocon Source block utilized in the gnuradio flow graph. Here are the steps I used:
    <ul>
      <li>Before running any of the gnuradio flow graph stuff, plug both HackRF SDR’s into your computer</li>
      <li>Pop open a terminal and run the $hackrf_info command</li>
      <li>Take a note with the device serial numbers (hopefully hackrf_info will list both a device 0 and device 1)</li>
      <li>Now open the rr-ps2.grc file from Michael Ossmann’s github and double click the osmocon Source block to pop open its propteries window</li>
      <li>In the device arguments field, enter: “hackrf=0”</li>
      <li>This will configure the gnuradio flow graph to utilize the first hackrf plugged into your system.</li>
      <li>You can now run this gnuradio flow graph and it will put one of your HackRF One to work as a reciever.</li>
      <li>To utilize your second HackRF one as a transmitter for this experiment, pop open a terminal window and run the following command: $hackrf_transfer -s 2000000 -a 0 -x 30 -c 64 -f 2482000000 -d [insert the serial number for the second HackRF you found with the hackrf_info command earlier]</li>
    </ul>

    <p>This should hopefully give you all the tools and tips you need to recreate my work!</p>
  </li>
</ul>

<hr />

<h2 id="demonstration-experiment">Demonstration Experiment</h2>

<iframe width="560" height="315" src="https://www.youtube.com/embed/4TWHpD3DRsQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<iframe width="560" height="315" src="https://www.youtube.com/embed/vBprW15IvQc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<hr />

<h2 id="open-questions">Open Questions</h2>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />According to folks who have recreated Michael Ossmann’s NSAPlayset CONGAFLOCK RF retro-reflector, the 2N7000 transistor should be able to backscatter RF. I tried to recreate their circuits to no success. While I know the 2N7000 cant actually switch at a rate of 2.482GHz, this shouldn’t matter since we are only requiring the tag to switch at 10khz - 500khz. I wonder if perhaps the 2N7000 can’t actually pass the 2.482GHz signal between drain and source while the gate is powered on?</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />The SKY65050 data sheet mentions that the transistor’s gate should be attached to 0v in order to make the biasing work but in the provided schematic of the evaluation board, the source and gate are actually connected to each other via a capacitor. I think I’m misunderstanding exactly what capacitor C3 is doing between the source and gate. Do I need C3 in my circuit? Should I disconnect source and gate from each other?</li>
</ul>

<hr />

<h2 id="references">References</h2>
<ul>
  <li><a href="https://en.m.wikipedia.org/wiki/The_Thing_(listening_device)">“The Thing” Wikipedia Article</a></li>
  <li><a href="https://youtu.be/mAai6dRAtFo">Michael Ossmann’s NSAPlayset DEFCON talk</a></li>
  <li><a href="https://github.com/mossmann/retroreflectors/blob/master/gnuradio-examples/rr-ps2.grc">Michael Ossmann’s Gnuradio Flow Graph Github</a></li>
  <li><a href="https://advancedpersistentjest.com/2020/01/20/notes-on-rf-retroreflectors/">Advanced Persistent Jest’s Notes on RF Retroreflectors</a></li>
  <li><a href="http://www.nsaplayset.org/">NSAPlayset</a></li>
  <li><a href="https://dl.acm.org/doi/abs/10.1145/3133956.3138830?casa_token=4WozLuT8dAcAAAAA:YD76cdwcsOG9AdTwDA-HTUbaAEKrMq9eSrmyeZRqxxo_urVE2k_rNWArm4_D0_kMxywsLmBYm-nX0A">POSTER: Is Active Electromagnetic Side-channel Attack Practical?</a></li>
</ul>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2021 Charles D. Ramey.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  



<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
